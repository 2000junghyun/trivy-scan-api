{
  "SchemaVersion": 2,
  "CreatedAt": "2025-10-19T10:54:21.862042+09:00",
  "ArtifactName": "test/tf/test_08.tf",
  "ArtifactType": "filesystem",
  "Results": [
    {
      "Target": ".",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 55,
        "Failures": 0
      }
    },
    {
      "Target": "terraform-aws-modules/security-group/aws/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 1
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "Security groups should not allow unrestricted ingress to SSH or RDP from any IP address.",
          "Description": "Security groups provide stateful filtering of ingress and egress network traffic to AWS\nresources. It is recommended that no security group allows unrestricted ingress access to\nremote server administration ports, such as SSH to port 22 and RDP to port 3389.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.aws.ec2.aws0107",
          "Query": "data.builtin.aws.ec2.aws0107.deny",
          "Resolution": "Set a more restrictive CIDR range",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-13",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-14",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "module.rules_two",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 197,
            "EndLine": 204,
            "Code": {
              "Lines": [
                {
                  "Number": 191,
                  "Content": "resource \"aws_security_group_rule\" \"ingress_with_cidr_blocks\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"ingress_with_cidr_blocks\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 192,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 197,
                  "Content": "  cidr_blocks = compact(split(",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcidr_blocks\u001b[0m =\u001b[38;5;33m compact\u001b[0m(\u001b[38;5;33msplit\u001b[0m(",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 198,
                  "Content": "    \",\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\",\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 199,
                  "Content": "    lookup(",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    lookup(",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 200,
                  "Content": "      var.ingress_with_cidr_blocks[count.index],",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mvar\u001b[0m.ingress_with_cidr_blocks[\u001b[38;5;33mcount\u001b[0m.index],",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 201,
                  "Content": "      \"cidr_blocks\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;37m\"cidr_blocks\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 202,
                  "Content": "      join(\",\", var.ingress_cidr_blocks),",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mjoin\u001b[0m(\u001b[38;5;37m\",\"\u001b[0m, \u001b[38;5;33mvar\u001b[0m.ingress_cidr_blocks),",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 203,
                  "Content": "    ),",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    ),",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 204,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group_rule.ingress_with_cidr_blocks[0]",
                "Filename": "terraform-aws-modules/security-group/aws/main.tf",
                "Location": {
                  "StartLine": 191,
                  "EndLine": 229
                }
              },
              {
                "Resource": "module.rules_two",
                "Filename": "test_08.tf",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 16
                }
              }
            ],
            "RenderedCause": {
              "Raw": "resource \"aws_security_group_rule\" \"ingress_with_cidr_blocks\" {\n  cidr_blocks = [\"0.0.0.0/0\"]\n}",
              "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"ingress_with_cidr_blocks\"\u001b[0m {\n  \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]\n}"
            }
          }
        }
      ]
    },
    {
      "Target": "test_08.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 3
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group",
          "AVDID": "AVD-AWS-0099",
          "Title": "Missing description for security group.",
          "Description": "Security groups should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group explicitly uses the default description.",
          "Namespace": "builtin.aws.ec2.aws0099",
          "Query": "data.builtin.aws.ec2.aws0099.deny",
          "Resolution": "Add descriptions for all security groups",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_security_group.test2",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 18,
            "EndLine": 28,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_security_group\" \"test2\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"test2\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  name        = \"allow_ssh_from_world\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m        = \u001b[38;5;37m\"allow_ssh_from_world\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  vpc_id      = \"SECRET\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mvpc_id\u001b[0m      = \u001b[38;5;37m\"SECRET\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "  ingress {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  ingress {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    from_port   = 22",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mfrom_port\u001b[0m   = \u001b[38;5;37m22",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "    to_port     = 22",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mto_port\u001b[0m     = \u001b[38;5;37m22",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "    protocol    = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mprotocol\u001b[0m    = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "Security groups should not allow unrestricted ingress to SSH or RDP from any IP address.",
          "Description": "Security groups provide stateful filtering of ingress and egress network traffic to AWS\nresources. It is recommended that no security group allows unrestricted ingress access to\nremote server administration ports, such as SSH to port 22 and RDP to port 3389.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.aws.ec2.aws0107",
          "Query": "data.builtin.aws.ec2.aws0107.deny",
          "Resolution": "Set a more restrictive CIDR range",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-13",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-14",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_security_group.test2",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 26,
            "EndLine": 26,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_security_group\" \"test2\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"test2\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  name        = \"allow_ssh_from_world\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m        = \u001b[38;5;37m\"allow_ssh_from_world\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  vpc_id      = \"SECRET\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mvpc_id\u001b[0m      = \u001b[38;5;37m\"SECRET\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "  ingress {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  ingress {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    from_port   = 22",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mfrom_port\u001b[0m   = \u001b[38;5;37m22",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "    to_port     = 22",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mto_port\u001b[0m     = \u001b[38;5;37m22",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "    protocol    = \"tcp\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mprotocol\u001b[0m    = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "ingress",
                "Filename": "test_08.tf",
                "Location": {
                  "StartLine": 22,
                  "EndLine": 27
                }
              },
              {
                "Resource": "aws_security_group.test2",
                "Filename": "test_08.tf",
                "Location": {
                  "StartLine": 18,
                  "EndLine": 28
                }
              }
            ]
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_security_group.test2",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 22,
            "EndLine": 27,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_security_group\" \"test2\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"test2\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  name        = \"allow_ssh_from_world\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m        = \u001b[38;5;37m\"allow_ssh_from_world\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  vpc_id      = \"SECRET\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mvpc_id\u001b[0m      = \u001b[38;5;37m\"SECRET\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "  ingress {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  ingress {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    from_port   = 22",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mfrom_port\u001b[0m   = \u001b[38;5;37m22",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "    to_port     = 22",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mto_port\u001b[0m     = \u001b[38;5;37m22",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "    protocol    = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mprotocol\u001b[0m    = \u001b[38;5;37m\"tcp\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group.test2",
                "Filename": "test_08.tf",
                "Location": {
                  "StartLine": 18,
                  "EndLine": 28
                }
              }
            ]
          }
        }
      ]
    }
  ]
}
